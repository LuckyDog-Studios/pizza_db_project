<!DOCTYPE html>
<html lang="en">
{% extends "base.html" %}

{% block content %}
<div>
    <h1>Order Now</h1>

    <!-- Flash messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="flash-messages">
                {% for category, message in messages %}
                    <div class="flash-message {{ category }}">{{ message }}</div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <!-- Tabs -->
    <div class="tab-buttons">
        <button class="tab-link active" data-tab="tab1">Pizza</button>
        <button class="tab-link" data-tab="tab2">Drinks</button>
        <button class="tab-link" data-tab="tab3">Dessert</button>
    </div>

    <!-- PIZZA TAB -->
    <div id="tab1" class="tab-content active">
        <form class="sections" method="POST" action="{{ url_for('order.add_to_order') }}">
            <input type="hidden" name="form_id" value="add-order-form">

            <div>
                <h2>Meat</h2>
                <label><input type="checkbox" name="pepperoni"> Pepperoni (‚Ç¨1.50)</label>
                <label><input type="checkbox" name="salami"> Salami (‚Ç¨1.50)</label>
                <label><input type="checkbox" name="ham"> Ham (‚Ç¨1.50)</label>
                <label><input type="checkbox" name="chicken"> Chicken (‚Ç¨1.80)</label>
                <label><input type="checkbox" name="beef"> Beef (‚Ç¨1.80)</label>
            </div>

            <div>
                <h2>Toppings</h2>
                <label><input type="checkbox" name="black_olive"> Black Olive (‚Ç¨1.00)</label>
                <label><input type="checkbox" name="mushrooms"> Mushrooms (‚Ç¨1.00)</label>
                <label><input type="checkbox" name="onions"> Onions (‚Ç¨0.80)</label>
                <label><input type="checkbox" name="green_peppers"> Green Peppers (‚Ç¨1.00)</label>
                <label><input type="checkbox" name="pineapple"> Pineapple (‚Ç¨1.00)</label>
                <label><input type="checkbox" name="basil"> Basil (‚Ç¨0.80)</label>
                <label><input type="checkbox" name="corn"> Corn (‚Ç¨0.80)</label>
            </div>

            <div>
                <h2>Cheeses + Base</h2>
                <label><input type="checkbox" name="mozzarella"> Mozzarella (‚Ç¨1.50)</label>
                <label><input type="checkbox" name="parmesan"> Parmesan (‚Ç¨1.50)</label>
                <label><input type="checkbox" name="tomato_sauce"> Tomato Sauce (Included)</label>
                <label><input type="checkbox" name="bbq_sauce"> BBQ Sauce (Included)</label>
            </div>

            <div>
                <button type="submit" class="add-btn">Add Pizza To Order</button>
            </div>
        </form>
    </div>

    <!-- DRINK TAB -->
    <div id="tab2" class="tab-content">
        <form class="sections" method="POST" action="{{ url_for('order.add_to_order') }}">
            <input type="hidden" name="form_id" value="drink-add-order-form">
            <div>
                <h2>Drinks</h2>
                <button type="submit" name="drink" value="Coca Cola">Coca Cola (‚Ç¨2.50)</button>
                <button type="submit" name="drink" value="Fanta">Fanta (‚Ç¨2.50)</button>
                <button type="submit" name="drink" value="Iced Tea">Iced Tea (‚Ç¨2.50)</button>
                <button type="submit" name="drink" value="Sprite">Sprite (‚Ç¨2.50)</button>
            </div>
        </form>
    </div>

    <!-- DESSERT TAB -->
    <div id="tab3" class="tab-content">
        <form class="sections" method="POST" action="{{ url_for('order.add_to_order') }}">
            <input type="hidden" name="form_id" value="dessert-add-order-form">
            <div>
                <h2>Dessert</h2>
                <button type="submit" name="dessert" value="Chocolate Cake">Chocolate Cake (‚Ç¨5.50)</button>
                <button type="submit" name="dessert" value="Tiramisu">Tiramisu (‚Ç¨5.80)</button>
                <button type="submit" name="dessert" value="Creme Brulee">Creme Brulee (‚Ç¨6.00)</button>
                <button type="submit" name="dessert" value="Vanilla Ice Cream">Vanilla Ice Cream (‚Ç¨4.50)</button>
            </div>
        </form>
    </div>

    <!-- CURRENT ORDER BOX -->
    <div class="order-box">
        <h2>Your Order</h2>

        {% if pizzas or drinks or desserts %}
            <ul id="order-list">
                {% for pizza in pizzas %}
                    <li class="order-item">
                        üçï <strong>Pizza #{{ loop.index }}</strong>: {{ pizza.ingredients|join(', ') }}
                        <span class="price">‚Ç¨{{ "%.2f"|format(pizza.price|float) }}</span>
                        <form method="POST" action="{{ url_for('order.remove_item') }}" class="inline-form">
                            <input type="hidden" name="pizza_id" value="{{ pizza.id }}">
                            <button type="submit" class="delete-btn">‚úï</button>
                        </form>
                    </li>
                {% endfor %}

                {% for drink in drinks %}
                    <li class="order-item">
                        ü•§ <strong>{{ drink.name }}</strong>
                        {% if drink.amount > 1 %} √ó{{ drink.amount }}{% endif %}
                        <span class="price">‚Ç¨{{ "%.2f"|format(drink.price|float) }}</span>
                        <form method="POST" action="{{ url_for('order.remove_item') }}" class="inline-form">
                            <input type="hidden" name="drink_id" value="{{ drink.id }}">
                            <button type="submit" class="delete-btn">‚úï</button>
                        </form>
                    </li>
                {% endfor %}

                {% for dessert in desserts %}
                    <li class="order-item">
                        üç∞ <strong>{{ dessert.name }}</strong>
                        {% if dessert.amount > 1 %} √ó{{ dessert.amount }}{% endif %}
                        <span class="price">‚Ç¨{{ "%.2f"|format(dessert.price|float) }}</span>
                        <form method="POST" action="{{ url_for('order.remove_item') }}" class="inline-form">
                            <input type="hidden" name="dessert_id" value="{{ dessert.id }}">
                            <button type="submit" class="delete-btn">‚úï</button>
                        </form>
                    </li>
                {% endfor %}
            </ul>

            <p id="order-total">Total: ‚Ç¨{{ total_price }}</p>

            {% if total_price|float > 0 %}
                <form method="GET" action="{{ url_for('order.checkout') }}">
                    <button type="submit" class="checkout-btn">Checkout</button>
                </form>
            {% else %}
                <button class="checkout-btn disabled" disabled
                        title="Can't go to checkout without ordering anything">
                    Checkout
                </button>
            {% endif %}
        {% else %}
            <p class="empty-order">Your order is currently empty üçï</p>
            <button class="checkout-btn disabled" disabled
                    title="Can't go to checkout without ordering anything">
                Checkout
            </button>
        {% endif %}
    </div>
</div>

<script src="{{ url_for('static', filename='js/order_tab_switch.js') }}"></script>
{% endblock %}
</html>